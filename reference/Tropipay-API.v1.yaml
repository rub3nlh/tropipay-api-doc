openapi: 3.0.0
info:
  title: Tropipay API
  version: '1.0'
  contact:
    name: Tropipay Team
    url: www.tropipay.com
    email: soporte@tropipay.com
  termsOfService: 'https://tropipay.com/terms'
  license:
    name: Tropipay - 2020 - All Right Reserved
  description: ''
servers:
  - description: Develop
    url: 'https://tropipay-dev.herokuapp.com/api'
paths:
  /access/login:
    post:
      summary: Getting API Token
      operationId: post-access-login
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                OK:
                  value:
                    user:
                      id: c01af560-c7f4-11e8-849a-1196b4225et9
                      name: John
                      surname: Doe
                      company: My Home
                      email: my@email.com
                      phone: '5555555555'
                      address: 'Catalunia Plaza, Barcelona'
                      walletId: null
                      t_c_version: /terms/v0.0
                      role: user
                      nationality: null
                      state: 1
                      balance: 923412
                      birthDate: '1986-02-03T23:00:00.000Z'
                      countryDestinationId: 1
                      city: Barcelona
                      postalCode: 8013
                      kycLevel: 3
                      occupationId: 6
                      clientTypeId: 1
                      isPublicOffice: false
                      birthCountryId: 0
                      province: Barcelona
                      groupId: 2
                      lastLogin: '2020-03-26T15:27:11.148Z'
                      pendingIn: -41380
                      pendingOut: 0
                      lang: es
                      shortId: YO6S
                      createdAt: '2018-10-04T16:44:24.380Z'
                      updatedAt: '2020-03-26T15:27:11.151Z'
                      validAirbnb: true
                    token: 'eyJhbGciOiJIUzI1NiIsInR5 {...} VPf-Uw'
                example-2: {}
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                KO:
                  value:
                    error:
                      message:
                        code: 8
                        msg: 'Wrong username or password!'
      parameters: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
            examples:
              Getting Token:
                value:
                  email: user@email.com
                  password: userP4SSW00rd
        description: Authentication
      tags:
        - Authentication
      description: "#### Using your Token for Authentication\nWith this endpoint you will receive a \"token\" parameter in the response. \n\nYou must use this parameter in the Header of all request you made for a Bearer authentication. \n\n> Header: { \"Authorization\" : \"Bearer {token}\" } "
  /paymentcards:
    get:
      summary: Get Payment Link List
      tags:
        - Payment Link
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Ex. Get Payment Link List OK:
                  value:
                    - id: 07bcff30-44fe-11ea-8ec4-d35783b2188a
                      reference: 2fe88rq17vak63ootcw
                      concept: Menu medio dia
                      description: "primer \nsedd\nerer"
                      amount: 2000
                      currency: USD
                      singleUse: false
                      reasonId: 3
                      userId: c01af560-c7f4-11e8-849a-1196b4225e29
                      qrImage: null
                      shortUrl: 'http://bit.ly/37O5but'
                      state: 1
                      expirationDays: 0
                      lang: es
                      urlSuccess: ''
                      urlFailed: ''
                      urlNotification: ''
                      expirationDate: null
                      serviceDate: null
                      createdAt: '2020-02-01T14:20:43.044Z'
                      updatedAt: '2020-02-01T14:20:43.532Z'
                    - id: c68fbe70-3d3d-11ea-adcf-9f02c8caee60
                      reference: 2fe88rqevek5plajtj
                      concept: cena para 2
                      description: bocadillos mistos
                      amount: 1200
                      currency: USD
                      singleUse: false
                      reasonId: 1
                      userId: c01af560-c7f4-11e8-849a-1196b4225e29
                      qrImage: null
                      shortUrl: 'http://bit.ly/36fBEIQ'
                      state: 1
                      expirationDays: 1
                      lang: es
                      urlSuccess: ''
                      urlFailed: ''
                      urlNotification: ''
                      expirationDate: null
                      serviceDate: null
                      createdAt: '2020-01-22T17:36:52.183Z'
                      updatedAt: '2020-01-22T17:36:52.647Z'
                    - id: 9b02a370-395b-11ea-ba39-91d98c954380
                      reference: 38t147fk5ij2m1y
                      concept: Comida para llevar
                      description: primer plato + segundo + postre
                      amount: 1000
                      currency: EUR
                      singleUse: false
                      reasonId: 1
                      userId: c01af560-c7f4-11e8-849a-1196b4225e29
                      qrImage: null
                      shortUrl: 'http://bit.ly/3ahcxbI'
                      state: 1
                      expirationDays: 1
                      lang: es
                      urlSuccess: ''
                      urlFailed: ''
                      urlNotification: 'https://webhook.site/947f5220-cfd7-4ab1-84e7-a6ea5f67fa01'
                      expirationDate: null
                      serviceDate: null
                      createdAt: '2020-01-17T19:00:19.369Z'
                      updatedAt: '2020-01-17T19:00:19.867Z'
      operationId: get-sd
      description: 'Get a List of all generated Paylinks. '
      parameters:
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
    parameters: []
    post:
      summary: Creating a Payment Link
      operationId: post-paymentcards
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  reference:
                    type: string
                  concept:
                    type: string
                  description:
                    type: string
                  amount:
                    type: integer
                  currency:
                    type: string
                  singleUse:
                    type: boolean
                  reasonId:
                    type: integer
                  expirationDays:
                    type: integer
                  userId:
                    type: string
                  lang:
                    type: string
                  state:
                    type: integer
                  urlSuccess:
                    type: string
                  urlFailed:
                    type: string
                  urlNotification:
                    type: string
                  expirationDate:
                    type: string
                  serviceDate:
                    type: string
                  hasClient:
                    type: boolean
                  updatedAt:
                    type: string
                  createdAt:
                    type: string
                  qrImage:
                    type: string
                  shortUrl:
                    type: string
                  paymentUrl:
                    type: string
              examples:
                Ex. Response OK:
                  value:
                    id: 94790650-f5a1-11e9-a5b8-8db2d78a55d6
                    reference: 23u4cgvz8k23djl85
                    concept: Gif Card - Experiencia culinaria.
                    description: Taxi + Experiencia
                    amount: 14000
                    currency: EUR
                    singleUse: true
                    reasonId: 1
                    expirationDays: 1
                    userId: 103ec000-703b-11e9-8aea-b7e74734087c
                    lang: es
                    state: 1
                    urlSuccess: 'https://mi-negocio.com/pago-ok'
                    urlFailed: 'https://mi-negocio.com/pago-ko'
                    urlNotification: 'https://mi-negocio.com/notificacion-pago'
                    expirationDate: '2020-04-30T00:00:00.000Z'
                    serviceDate: '2020-04-23T00:00:00.000Z'
                    hasClient: false
                    updatedAt: '2019-10-23T14:29:54.628Z'
                    createdAt: '2019-10-23T14:29:54.102Z'
                    qrImage: 'data:image/png;base64,iVBORw0KG {...} XoGCsAAAAABJRU5ErkJggg=='
                    shortUrl: 'http://bit.ly/2WbaJKS'
                    paymentUrl: null
                Ex. Response OK (Skip Form asking for Client Data in the Payment Flow):
                  value:
                    id: 94790650-f5a1-11e9-a5b8-8db2d78a55d6
                    reference: 23u4cgvz8k23djl85
                    concept: Gif Card - Experiencia culinaria.
                    description: Taxi + Experiencia
                    amount: 14000
                    currency: EUR
                    singleUse: true
                    reasonId: 1
                    expirationDays: 1
                    userId: 103ec000-703b-11e9-8aea-b7e74734087c
                    lang: es
                    state: 1
                    urlSuccess: 'https://mi-negocio.com/pago-ok'
                    urlFailed: 'https://mi-negocio.com/pago-ko'
                    urlNotification: 'https://mi-negocio.com/notificacion-pago'
                    expirationDate: '2020-04-30T00:00:00.000Z'
                    serviceDate: '2020-04-23T00:00:00.000Z'
                    hasClient: true
                    updatedAt: '2019-10-23T14:29:54.628Z'
                    createdAt: '2019-10-23T14:29:54.102Z'
                    qrImage: 'data:image/png;base64,iVBORw0KG {...} XoGCsAAAAABJRU5ErkJggg=='
                    shortUrl: 'http://bit.ly/2WbaJKS'
                    paymentUrl: null
                Ex. Response OK (Payment Link Directly):
                  value:
                    id: 94790650-f5a1-11e9-a5b8-8db2d78a55d6
                    reference: 23u4cgvz8k23djl85
                    concept: Gif Card - Experiencia culinaria.
                    description: Taxi + Experiencia
                    amount: 14000
                    currency: EUR
                    singleUse: true
                    reasonId: 1
                    expirationDays: 1
                    userId: 103ec000-703b-11e9-8aea-b7e74734087c
                    lang: es
                    state: 1
                    urlSuccess: 'https://mi-negocio.com/pago-ok'
                    urlFailed: 'https://mi-negocio.com/pago-ko'
                    urlNotification: 'https://mi-negocio.com/notificacion-pago'
                    expirationDate: '2020-04-30T00:00:00.000Z'
                    serviceDate: '2020-04-23T00:00:00.000Z'
                    hasClient: true
                    updatedAt: '2019-10-23T14:29:54.628Z'
                    createdAt: '2019-10-23T14:29:54.102Z'
                    qrImage: 'data:image/png;base64,iVBORw0KG {...} XoGCsAAAAABJRU5ErkJggg=='
                    shortUrl: 'http://bit.ly/2WbaJKS'
                    paymentUrl: 'https://api.paycomet.com/gateway/ifr-bankstore {...} pagoko'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Invalid Token Example:
                  value:
                    error:
                      msg: 'Failed to authenticate token!'
                      code: 934
      tags:
        - Payment Link
      description: "Charge to your clients or receive a remitance to your account by charge credits cards. \n\nYou will get a short URL and a QR code with the Payment Link \n\n#### Callbacks:\n\nThe result of the operation will be notified in a Callback with a POST to **urlNotification** parameter.\n\n> Note: We are working on a WebHook structure to avoid the notification parameter.\n\n#### Callback Signature: \nAll callbacks contains the parameter signature that validate it is a verified Tropipay Callback. \nYou need check the signature of any callback for security reasons:\n\n`signature = sha256( bankOrderCode + userEmail + sha1(userPassword) + originalCurrencyAmount )\n`\n\n#### Callback Response Examples: \n\nResponse OK\n\n```json\n{\n  status: \"OK\",\n  data: {\n    \"id\": 27376,\n    \"reference\": \"1574194435610\",\n    \"bankOrderCode\": \"1574194435610\",\n    \"provider\": 4,\n    \"userId\": \"103ec000-703b-11e9-8aea-b7e74734087c\",\n    \"bookingDate\": \"2019-11-19T20:13:55.613Z\",\n    \"days\": null,\n    \"amount\": 100000,\n    \"currency\": \"EUR\",\n    \"originalCurrencyAmount\": 100000,\n    \"destinationAmount\": 96450,\n    \"destinationCurrency\": \"EUR\",\n    \"conversionRate\": 1,\n    \"depositaccountId\": null,\n    \"state\": 5,\n    \"serviceId\": 2,\n    \"paymentcardId\": \"95aa7620-0b05-11ea-b517-dfa69b738ed5\",\n    \"expirationDate\": \"2019-11-20T08:55:00.000Z\",\n    \"movementTypeId\": 2,\n    \"balanceBefore\": null,\n    \"balanceAfter\": null,\n    \"createdAt\": \"2019-11-19T20:13:55.614Z\",\n    \"updatedAt\": \"2019-11-19T20:30:04.083Z\",\n    \"paymentcard\": {\n      \"id\": \"95aa7620-0b05-11ea-b517-dfa69b738ed5\",\n      \"reference\": \"di3khs1p0k369tj0h\",\n      \"concept\": \"concept1\",\n      \"description\": \"description1\",\n      \"amount\": 100000,\n      \"currency\": \"EUR\",\n      \"singleUse\": false,\n      \"reasonId\": 4,\n      \"userId\": \"103ec000-703b-11e9-8aea-b7e74734087c\",\n      \"qrImage\": null,\n      \"shortUrl\": null,\n      \"state\": 1,\n      \"expirationDays\": 1,\n      \"lang\": \"es\",\n      \"urlSuccess\": \"https://mi-negocio.com/pago-ok\",\n      \"urlFailed\": \"https://mi-negocio.com/pago-ko\",\n      \"urlNotification\": \"https://mi-negocio.com/notificacion-de-pago\",\n      \"createdAt\": \"2019-11-19T19:48:40.194Z\",\n      \"updatedAt\": \"2019-11-19T19:48:40.194Z\"\n    },\n    \"charges\": [\n      {\n        \"id\": 22742,\n        \"orderCode\": \"1574194435610\",\n        \"cardPan\": \"0000\",\n        \"cardExpirationDate\": \"2020-01-01T00:00:00.000Z\",\n        \"cardHolderName\": \"Antonio\",\n        \"amount\": 1000,\n        \"currency\": 978,\n        \"userId\": \"103ec000-703b-11e9-8aea-b7e74734087c\",\n        \"bookingId\": 27376,\n        \"errorReason\": \"\",\n        \"state\": 3,\n        \"serviceId\": 2,\n        \"cardCountry\": \"\",\n        \"cardBrand\": \"VISA\",\n        \"cardCategory\": \"BUSINESS\",\n        \"cardType\": \"CREDIT\",\n        \"clientIp\": \"\",\n        \"clientName\": \"Antonio\",\n        \"clientLastName\": \"Lopez\",\n        \"clientAddress\": \"calle 280\",\n        \"clientPhone\": \"5300000000\",\n        \"clientEmail\": \"user@gmail.com\",\n        \"clientTC\": \"true\",\n        \"clientCountryId\": 0,\n        \"createdAt\": \"2019-11-19T20:13:55.666Z\",\n        \"updatedAt\": \"2019-11-19T20:30:04.066Z\"\n      }\n    ]\n  }\n}\n```"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reference:
                  type: string
                  description: reference in your system
                concept:
                  type: string
                  description: ''
                description:
                  type: string
                amount:
                  type: integer
                  default: 0
                  description: Cents
                  format: int32
                  example: 1000
                currency:
                  type: string
                  description: 'EUR,USD (ISO)'
                singleUse:
                  type: boolean
                  description: true - payment link is closed after use it
                reasonId:
                  type: integer
                  description: See reasson list section for details
                expirationDays:
                  type: integer
                  description: How many days you allow order cancelation
                lang:
                  type: string
                  description: 'Link Payment Language (es,en,pt)'
                urlSuccess:
                  type: string
                  description: OK response redirect to this URL
                urlFailed:
                  type: string
                  description: KO response redirect to this URL
                urlNotification:
                  type: string
                  description: Callback notification with the response data
                client:
                  type:
                    - 'null'
                    - object
                  description: 'If the client param exist and it is different of null the payment flow will skip the form asking for client data. '
                  properties:
                    name:
                      type: string
                      description: Client Name
                    lastName:
                      type: string
                      description: Client Last Name
                    address:
                      type: string
                      description: CLient Address
                    phone:
                      type: string
                      description: Client Phone
                    email:
                      type: string
                      description: Client Email
                    termsAndConditions:
                      type: boolean
                      description: Client accept Terms and Conditions
                    countryId:
                      type: integer
                      description: Client Country Id (You must see country endpoint)
                  required:
                    - name
                    - lastName
                    - address
                    - phone
                    - email
                    - termsAndConditions
                    - countryId
                expirationDate:
                  type: string
                  default: yyyy-mm-dd
                  description: The payment link will be destroyed this date
                  format: date
                  example: '2020-06-26'
                serviceDate:
                  type: string
                  default: yyyy-mm-dd
                  description: required if singleUse is true. The date of the service
                  format: date
                  example: '2020-03-25'
                directPayment:
                  type: boolean
                  example: 'Allows to generate the payment link directly, the client, urlSuccess and urlFailed keys are required'
              required:
                - reference
                - concept
                - description
                - amount
                - currency
                - singleUse
                - reasonId
            examples:
              'Creating a Recurrent Payment Link ':
                value:
                  reference: your-own-system-reference
                  concept: test
                  description: test
                  amount: 100000
                  currency: EUR
                  singleUse: false
                  reasonId: 2
                  expirationDays: 1
                  lang: es
                  urlSuccess: 'https://mi-negocio.com/pago-ok'
                  urlFailed: 'https://mi-negocio.com/pago-ko'
                  urlNotification: 'https://mi-negocio.com/notificacion-pago'
              Ex. Creating a Paylink (Skip Form asking for Client Data in the Payment Flow):
                value:
                  reference: your-own-system-reference
                  concept: test
                  description: test
                  amount: 100000
                  currency: EUR
                  singleUse: true
                  reasonId: 2
                  expirationDays: 5
                  lang: es
                  urlSuccess: 'https://mi-negocio.com/pago-ok'
                  urlFailed: 'https://mi-negocio.com/pago-ko'
                  urlNotification: 'https://mi-negocio.com/notificacion-pago'
                  client:
                    name: John
                    lastName: Doe
                    address: 'Ave. Guadí 232, Barcelona, Barcelona'
                    phone: '+34645553333'
                    email: client@email.com
                    countryId: 1
                    termsAndConditions: true
              Ex. Creating a Paylink (Get the Payment Link Directly):
                value:
                  reference: your-own-system-reference
                  concept: test
                  description: test
                  amount: 100000
                  currency: EUR
                  singleUse: true
                  reasonId: 2
                  expirationDays: 5
                  lang: es
                  urlSuccess: 'https://mi-negocio.com/pago-ok'
                  urlFailed: 'https://mi-negocio.com/pago-ko'
                  urlNotification: 'https://mi-negocio.com/notificacion-pago'
                  client:
                    name: John
                    lastName: Doe
                    address: 'Ave. Guadí 232, Barcelona, Barcelona'
                    phone: '+34645553333'
                    email: client@email.com
                    countryId: 1
                    termsAndConditions: true
                  directPayment: true
        description: |-
          #### Reasons (Payment reason ids):
          -  0 : Tourist Service
          -  1 : Remittance
          -  2 : Personal
          -  3 : Generic Service
      parameters:
        - schema:
            type: string
          in: header
          description: 'Bearer {your-token}'
          name: Authorization
          required: true
  /booking:
    get:
      summary: Getting Transactions List
      tags:
        - Transactions
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
              examples:
                Ex. Response OK:
                  value:
                    count: 2
                    rows:
                      - id: 29950
                        reference: 'DEV:TX1579007965129'
                        bankOrderCode: 'DEV:TX1579007965129'
                        provider: 4
                        userId: c01af560-c7f4-11e8-849a-1196b4225e29
                        bookingDate: null
                        days: null
                        amount: 835
                        currency: EUR
                        originalCurrencyAmount: null
                        destinationAmount: 835
                        destinationCurrency: EUR
                        conversionRate: null
                        providerFee: null
                        ourFee: null
                        realBankFee: null
                        depositaccountId: null
                        payProviderFee: null
                        state: 2
                        serviceId: 3
                        paymentcardId: null
                        expirationDate: null
                        movementTypeId: 3
                        balanceBefore: 715812
                        balanceAfter: 824638
                        createdAt: '2020-01-14T13:19:25.130Z'
                        updatedAt: '2020-01-21T13:13:32.611Z'
                        depositaccount: null
                        service:
                          id: 3
                          name: Recharge
                          slug: RECHARGE
                          service_fee_percent: 0
                          service_fee_fixed: 0
                          tp_fee_percent: 1000
                          tp_fee_fixed: 0
                          type: MARKET_PLACE
                          createdAt: '2019-12-11T11:55:08.025Z'
                          updatedAt: '2019-12-11T11:55:08.025Z'
                        charges: []
                        purchases:
                          - id: 30
                            bookingId: 29950
                            marketproductId: 24
                            target: someuser@nauta.com.cu
                            specification: '1000'
                            providerSpot: 1771
                            fee: -0.121
                            createdAt: '2020-01-14T13:19:25.145Z'
                            updatedAt: '2020-01-14T13:19:25.145Z'
                            marketproduct:
                              slug: nauta01
                      - id: 29936
                        reference: TX1578581766040
                        bankOrderCode: TX1578581766040
                        provider: null
                        userId: c01af560-c7f4-11e8-849a-1196b4225e29
                        bookingDate: null
                        days: null
                        amount: -900
                        currency: EUR
                        originalCurrencyAmount: null
                        destinationAmount: -900
                        destinationCurrency: EUR
                        conversionRate: null
                        providerFee: null
                        ourFee: null
                        realBankFee: null
                        depositaccountId: null
                        payProviderFee: null
                        state: 3
                        serviceId: 3
                        paymentcardId: null
                        expirationDate: null
                        movementTypeId: 1
                        balanceBefore: 738552
                        balanceAfter: 737652
                        createdAt: '2020-01-09T14:56:06.041Z'
                        updatedAt: '2020-01-09T14:56:06.041Z'
                        depositaccount: null
                        service:
                          id: 3
                          name: Recharge
                          slug: RECHARGE
                          service_fee_percent: 0
                          service_fee_fixed: 0
                          tp_fee_percent: 1000
                          tp_fee_fixed: 0
                          type: MARKET_PLACE
                          createdAt: '2019-12-11T11:55:08.025Z'
                          updatedAt: '2019-12-11T11:55:08.025Z'
                        charges: []
                        purchases:
                          - id: 16
                            bookingId: 29936
                            marketproductId: 24
                            target: someuser@nauta.com.cu
                            specification: '1078'
                            providerSpot: 1771
                            fee: 0.130419161676647
                            createdAt: '2020-01-09T14:56:06.065Z'
                            updatedAt: '2020-01-09T14:56:06.065Z'
                            marketproduct:
                              slug: nauta01
                    limit: '10'
                    offset: '0'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Ex. KO Unauthorized:
                  value:
                    error:
                      msg: 'Failed to authenticate token!'
      operationId: get-booking
      description: "List All Transactions made by User.\n\nOnly states Charged and Paid.\n\nTransactions in state New and Error are not returned. "
      parameters:
        - schema:
            type: number
          in: query
          name: offset
          description: Pagination Offset - Default 0
        - schema:
            type: number
          in: query
          name: limit
          description: Pagination Limit - Default 10
        - schema:
            type: string
          in: query
          name: criteria
          description: 'Search Criteria (orderCode, Reference, Purchase.target)'
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
  /booking/charge:
    post:
      summary: Charge an OTA Virtual Card
      operationId: post-booking-charge
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
              examples:
                Ex. Charge Url created:
                  value:
                    id: 29964
                    reference: referencia001
                    bankOrderCode: k5ijdex8
                    provider: 1
                    userId: c01af560-c7f4-11e8-849a-1196b4225e29
                    bookingDate: '2020-01-16T00:00:00.000Z'
                    amount: 9012
                    currency: USD
                    originalCurrencyAmount: 10055
                    destinationAmount: 8291
                    destinationCurrency: EUR
                    conversionRate: 1.1157
                    state: 1
                    serviceId: 1
                    movementTypeId: 2
                    updatedAt: '2020-01-17T19:08:43.353Z'
                    createdAt: '2020-01-17T19:08:43.340Z'
                    paymentUrl:
                      chargeUrl: 'https://booking.charge.url/213oieoi2132'
      tags:
        - Transactions
      description: "### Charge an OTA Card:\nCreate a charge Url for an OTA Virtual Credit Card.\n\nYou Must send to ***soporte@tropipay.com*** an URL for receiving the Callback with the operation response.\n\n> Note:  We are working on Webhooks structures to avoiding this send URL configuration step. \n\n### How to complete the charge:\nWith the response you will receive the **chargeUrl** parameter with the form to add the data card and complete the payment.  \n\n### Masters Ids (Providers, States, Services, MovementType): \n[Go to Masters >> >> ](./docs/Masters/Masters-Tables-Data.md)"
      parameters:
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reference:
                  type: string
                  description: Your unique reference
                  example: ref2334kk23
                provider:
                  type: integer
                  description: 'ProviderId (Booking, Expedia, Hotels,etc..)'
                  example: 1
                bookingDate:
                  type: string
                  description: Date of the service
                  format: date
                  example: '2020-01-16'
                originalCurrencyAmount:
                  type: integer
                  description: Amount in Cents
                  example: 1000
                currency:
                  type: string
                  description: 'Iso Currency (EUR, USD)'
                  example: USD
                lang:
                  type: string
                  description: 'Lang (es, en)'
                  example: es
                agree:
                  type: boolean
                  description: Client accept terms and conditions
                  example: 'true'
                customUrlOK:
                  type: string
                  description: Redirect to this url with a OK charge
                  example: 'https://mydomain.com/payment_ok'
                customUrlKO:
                  type: string
                  description: Redirect to this url with a KO charge
                  example: 'https://mydomain.com/payment_ko'
              required:
                - reference
                - provider
                - bookingDate
                - originalCurrencyAmount
                - currency
                - lang
                - agree
            examples:
              Ex. Creating a Charge URL:
                value:
                  reference: referencia001
                  provider: 1
                  bookingDate: '2020-01-16'
                  originalCurrencyAmount: 10055
                  currency: USD
                  lang: es
                  agree: true
                  customUrlOK: 'https://google.com'
                  customUrlKO: 'https://yahoo.es'
        description: ''
  '/marketproducts/{productId}/consume':
    parameters:
      - schema:
          type: string
        name: productId
        in: path
        required: true
        description: Product Id you want to consume (ex. recharge01)
    post:
      summary: Consume a Market Product
      operationId: post-marketproducts-productId-consume
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Ex. Response OK Consume Cubacel Air Time Recharge:
                  value:
                    status: OK
                    transaction:
                      id: 30039
                      reference: TX1583416644851
                      bankOrderCode: TX1583416644851
                      userId: c01af560-c7f4-11e8-849a-1196b4225e29
                      amount: -1800
                      currency: EUR
                      destinationAmount: -1800
                      destinationCurrency: EUR
                      state: 2
                      movementTypeId: 1
                      serviceId: 3
                      updatedAt: '2020-03-05T13:57:24.852Z'
                      createdAt: '2020-03-05T13:57:24.852Z'
                      transactionId: null
      tags:
        - Market
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
            examples:
              'Ex. Consume a Cubacel Air Time Recharge (productId : recharge01)':
                value:
                  amount: 2000
                  target: '5355555555'
                  operatorId: CU_CU_TopUp
                  notificationUrl: 'https://webhook.site/f6ce41f9-1ea2-4c58-94c4-004967f4erad'
        description: ''
      description: "Consume a product from market. \n\nMarket product Id List: \n\n- recharge01  (AIR TIME)\n\n\nOperator Id List:\n\n{...}\n\nThe response from this endpoint is that the order has been taken.\n\n#### Callbacks: \nThe result of the operation will be notified in a Callback with a POST to **notificationUrl** parameter.\n\n> Note: We are working on a WebHook structure to avoid the notification parameter.\n\n#### Callback Signature: \nAll callbacks contains the parameter signature that validate it is a verified Tropipay Callback. \nYou need check the signature of any callback for security reasons:\n\n`signature = sha256( bankOrderCode + userEmail + sha1(userPassword) + purchaseTarget )\n`\n\n\n#### Callback Responses Examples: \n\nResponse OK\n\n```json\n{\n  \"status\": \"OK\",\n  \"signature\": \"8f417ae204273e8bddbdf961700b62a4e27eceed110df63df3fd6e7048f248ea\",\n  \"data\": {\n    \"transaction\": {\n      \"id\": 30039,\n      \"reference\": \"TX1583416644851\",\n      \"bankOrderCode\": \"TX1583416644851\",\n      \"userId\": \"c01af560-c7f4-11e8-849a-1196b4225e29\",\n      \"amount\": -1800,\n      \"currency\": \"EUR\",\n      \"destinationAmount\": -1800,\n      \"destinationCurrency\": \"EUR\",\n      \"state\": 3,\n      \"serviceId\": 3,\n      \"movementTypeId\": 1,\n      \"createdAt\": \"2020-03-05T13:57:24.852Z\",\n      \"updatedAt\": \"2020-03-05T13:57:27.008Z\",\n      \"purchase\": {\n        \"target\": \"5352634610\"\n      }\n    },\n    \"error\": {}\n  }\n}\n```\n\nResponse KO\n\n```json\n{\n  \"status\": \"KO\",\n  \"signature\": \"8f417ae204273e8bddbdf961700b62a4e27eceed110df63df3fd6e7048f248ea\",\n  \"data\": {\n    \"transaction\": {\n      \"id\": 30039,\n      \"reference\": \"TX1583416644851\",\n      \"bankOrderCode\": \"TX1583416644851\",\n      \"userId\": \"c01af560-c7f4-11e8-849a-1196b4225e29\",\n      \"amount\": -1800,\n      \"currency\": \"EUR\",\n      \"destinationAmount\": -1800,\n      \"destinationCurrency\": \"EUR\",\n      \"state\": 4,\n      \"serviceId\": 3,\n      \"movementTypeId\": 1,\n      \"createdAt\": \"2020-03-05T13:57:24.852Z\",\n      \"updatedAt\": \"2020-03-05T13:57:27.008Z\",\n      \"purchase\": {\n        \"target\": \"5352634610\"\n      }\n    },\n    \"error\": {\n      \"code\": \"MP_006\",\n      \"msg\": \"Provider Error\"\n    }\n  }\n}\n```\n\n"
      parameters:
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
  /paymentcards/notify:
    post:
      summary: Payment Link Send a Notification
      operationId: post-paymentcards-notify
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Ex. Response OK:
                  value: OK
      tags:
        - Payment Link
      description: 'Send a notification with the paymeyt link url to someone. '
      parameters:
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
            examples:
              Ex. Notify a client with a payment link url:
                value:
                  cardObj:
                    id: 3a16d4f0-f667-11e9-9445-0f8921378a1d
                  sendEmail: true
                  email: client@email.com
                  sendSMS: true
                  phone: '+53534555555'
                  lang: es
  /country:
    get:
      summary: Get operational Country List
      tags:
        - Countries
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties: {}
              examples:
                Response OK:
                  value:
                    count: 248
                    rows:
                      - id: 44
                        name: Afghanistan
                        sepaZone: false
                        state: 1
                        slug: AF
                        callingCode: 93
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.410Z'
                        updatedAt: '2019-09-03T15:22:26.410Z'
                      - id: 43
                        name: Albania
                        sepaZone: false
                        state: 1
                        slug: AL
                        callingCode: 355
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.410Z'
                        updatedAt: '2019-09-03T15:22:26.410Z'
                      - id: 5
                        name: Alemania
                        sepaZone: true
                        state: 1
                        slug: DE
                        callingCode: 49
                        isDestination: true
                        createdAt: '2019-05-14T09:37:40.349Z'
                        updatedAt: '2019-05-14T09:37:40.349Z'
                      - id: 42
                        name: Algeria
                        sepaZone: false
                        state: 1
                        slug: DZ
                        callingCode: 213
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.411Z'
                        updatedAt: '2019-09-03T15:22:26.411Z'
                      - id: 40
                        name: American Samoa
                        sepaZone: false
                        state: 1
                        slug: AS
                        callingCode: 1684
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.411Z'
                        updatedAt: '2019-09-03T15:22:26.411Z'
                      - id: 41
                        name: Andorra
                        sepaZone: true
                        state: 1
                        slug: AD
                        callingCode: 376
                        isDestination: true
                        createdAt: '2019-09-03T15:22:26.411Z'
                        updatedAt: '2019-10-18T10:21:13.673Z'
                      - id: 45
                        name: Angola
                        sepaZone: false
                        state: 1
                        slug: AO
                        callingCode: 244
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.416Z'
                        updatedAt: '2019-09-03T15:22:26.416Z'
                      - id: 46
                        name: Anguilla
                        sepaZone: false
                        state: 1
                        slug: AI
                        callingCode: 1264
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.417Z'
                        updatedAt: '2019-09-03T15:22:26.417Z'
                      - id: 47
                        name: Antarctica
                        sepaZone: false
                        state: 1
                        slug: AQ
                        callingCode: 672
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.418Z'
                        updatedAt: '2019-09-03T15:22:26.418Z'
                      - id: 48
                        name: Antigua and Barbuda
                        sepaZone: false
                        state: 1
                        slug: AG
                        callingCode: 1268
                        isDestination: false
                        createdAt: '2019-09-03T15:22:26.418Z'
                        updatedAt: '2019-09-03T15:22:26.418Z'
                    limit: 20
                    offset: 0
      operationId: get-country
      description: ''
      parameters:
        - schema:
            type: string
          in: header
          name: Authorization
          description: 'Bearer {your-token}'
          required: true
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                limit:
                  type: integer
                offset:
                  type: integer
            examples:
              Ex. Pagination:
                value:
                  limit: 10
                  offset: 0
        description: ''
components:
  schemas: {}
